<%- include('../partials/header') %>

<h1><%= experience.title %></h1>

<!-- Styled mood & music tags -->
<div>
  <span class="tag"><%= experience.mood %></span>
  <span class="tag"><%= experience.music %></span>
</div>

<p><strong>Day:</strong> <%= experience.dayOfWeek %></p>
<p><strong>Ambiance:</strong> <%= experience.ambiance %></p>

<% if (experience.playlistUrl) { %>
  <p><strong>Playlist:</strong> 
    <a href="<%= experience.playlistUrl %>" target="_blank">Listen</a>
  </p>
<% } %>

<hr />
<h2>Menu</h2>

<% if (experience.meals.length > 0) { %>
  <ul>
    <% experience.meals.forEach(meal => { %>
      <li>
        <strong><%= meal.name %></strong>: <%= meal.description %>

        <!-- ğŸ—‘ Delete Meal -->
        <form 
          action="/experiences/<%= experience._id %>/meals/<%= meal._id %>?_method=DELETE" 
          method="POST" 
          style="display:inline;"
        >
          <button type="submit" onclick="return confirm('Delete this meal?')">ğŸ—‘</button>
        </form>

        <!-- âœï¸ Edit Meal Form -->
        <form 
          action="/experiences/<%= experience._id %>/meals/<%= meal._id %>?_method=PUT" 
          method="POST" 
          style="margin-top: 0.5rem;"
        >
          <input type="text" name="name" value="<%= meal.name %>" required />
          <input type="text" name="description" value="<%= meal.description %>" required />
          <button type="submit">âœï¸ Save</button>
        </form>
      </li>
    <% }) %>
  </ul>
<% } else { %>
  <p>No meals added yet.</p>
<% } %>

<hr />
<h2>Add a Meal</h2>

<form action="/experiences/<%= experience._id %>/meals" method="POST">
  <label>Meal Name:</label>
  <input type="text" name="name" required />

  <label>Description:</label>
  <input type="text" name="description" required />

  <button type="submit">Add Meal</button>
</form>

<hr />
<!-- ğŸ—‘ Delete This Experience -->
<form 
  action="/experiences/<%= experience._id %>?_method=DELETE" 
  method="POST"
  style="display:inline;"
>
  <button type="submit" onclick="return confirm('Are you sure you want to delete this experience?')">
    ğŸ—‘ Delete This Experience
  </button>
</form>

<br />
<a href="/experiences">â† Back to All Experiences</a>

<%- include('../partials/footer') %>
